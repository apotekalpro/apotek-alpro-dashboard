<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance Invoice Matching System - Complete Invoice Data Export</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .file-upload-area {
            border: 2px dashed #d1d5db;
            transition: all 0.3s ease;
        }
        
        .file-upload-area:hover {
            border-color: #6366f1;
            background-color: #f8fafc;
        }
        
        .file-upload-area.dragover {
            border-color: #4f46e5;
            background-color: #eef2ff;
        }
        
        .progress-bar {
            transition: width 0.3s ease-in-out;
        }
        
        .stats-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .matched-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .unmatched-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .rate-card {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }
        
        .export-btn {
            transition: all 0.3s ease;
        }
        
        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .company-tag {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .table-container {
            max-height: none;
            overflow: visible;
        }
        
        .results-section {
            page-break-inside: avoid;
        }

         {
            .no-print {
                display: none !important;
            }
            
            .print-full-width {
                width: 100% !important;
                max-width: none !important;
            }
            
            .table-container {
                overflow: visible !important;
            }
        }
        /* Force orange buttons with high specificity */
button[id*="Unmatched"] {
    background-color: #ea580c !important; /* Orange-600 */
    color: white !important;
    border: 1px solid #ea580c !important;
}

button[id*="Unmatched"]:hover {
    background-color: #c2410c !important; /* Orange-700 */
    border-color: #c2410c !important;
}

/* Alternative - target by specific IDs */
#exportAllUnmatched, 
#exportPKUUnmatched, 
#exportPRIUnmatched, 
#exportAPDUnmatched {
    background-color: #ea580c !important;
    color: white !important;
    border: 1px solid #ea580c !important;
}

    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <div class="bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 text-white py-6 mb-8">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold flex items-center">
                        <i class="fas fa-calculator mr-3"></i>
                        Finance Invoice Matching System
                    </h1>
                    <p class="text-indigo-100 mt-2">Complete Invoice Data Export • Last 8 Digits Matching • HERMED Filter • Company ID • APD Support</p>
                </div>
                <div class="text-right">
                    <div class="bg-white bg-opacity-20 rounded-lg px-4 py-2">
                        <span class="text-sm font-medium">Status:</span>
                        <span id="systemStatus" class="ml-2 font-bold">System Ready</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="max-w-7xl mx-auto px-4 space-y-8">
        
        <!-- File Upload Section -->
        <div class="bg-white rounded-xl shadow-lg p-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                <i class="fas fa-cloud-upload-alt mr-3 text-indigo-600"></i>
                File Upload
            </h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-6">
                <!-- PKU CoreTax File -->
                <div class="space-y-3">
                    <label class="text-sm font-semibold text-gray-700 flex items-center">
                        <i class="fas fa-file-excel mr-2 text-green-600"></i>
                        PKU CoreTax File
                    </label>
                    <div class="file-upload-area rounded-lg p-6 text-center cursor-pointer" id="pkuUploadArea">
                        <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-3"></i>
                        <p class="text-sm text-gray-600">Drop PKU file here or click to browse</p>
                        <p class="text-xs text-gray-500 mt-1">Supports .xlsx files</p>
                        <input type="file" id="pkuFile" accept=".xlsx,.xls" class="hidden">
                    </div>
                    <div id="pkuStatus" class="text-sm"></div>
                </div>

                <!-- PRI CoreTax File -->
                <div class="space-y-3">
                    <label class="text-sm font-semibold text-gray-700 flex items-center">
                        <i class="fas fa-file-excel mr-2 text-blue-600"></i>
                        PRI CoreTax File
                    </label>
                    <div class="file-upload-area rounded-lg p-6 text-center cursor-pointer" id="priUploadArea">
                        <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-3"></i>
                        <p class="text-sm text-gray-600">Drop PRI file here or click to browse</p>
                        <p class="text-xs text-gray-500 mt-1">Supports .xlsx files</p>
                        <input type="file" id="priFile" accept=".xlsx,.xls" class="hidden">
                    </div>
                    <div id="priStatus" class="text-sm"></div>
                </div>

                <!-- APD CoreTax File (Optional) -->
                <div class="space-y-3">
                    <label class="text-sm font-semibold text-gray-700 flex items-center">
                        <i class="fas fa-file-excel mr-2 text-purple-600"></i>
                        APD CoreTax File
                        <span class="ml-2 px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full">Optional</span>
                    </label>
                    <div class="file-upload-area rounded-lg p-6 text-center cursor-pointer" id="apdUploadArea">
                        <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-3"></i>
                        <p class="text-sm text-gray-600">Drop APD file here or click to browse</p>
                        <p class="text-xs text-gray-500 mt-1">Optional - Supports .xlsx files</p>
                        <input type="file" id="apdFile" accept=".xlsx,.xls" class="hidden">
                    </div>
                    <div id="apdStatus" class="text-sm"></div>
                </div>

                <!-- Invoice Matching Files -->
                <div class="space-y-3">
                    <label class="text-sm font-semibold text-gray-700 flex items-center">
                        <i class="fas fa-files mr-2 text-orange-600"></i>
                        Invoice Matching Files
                    </label>
                    <div class="file-upload-area rounded-lg p-6 text-center cursor-pointer" id="invoiceUploadArea">
                        <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-3"></i>
                        <p class="text-sm text-gray-600">Drop multiple files here or click to browse</p>
                        <p class="text-xs text-gray-500 mt-1">Supports multiple .xlsx files</p>
                        <input type="file" id="invoiceFiles" accept=".xlsx,.xls" multiple class="hidden">
                    </div>
                    <div id="invoiceStatus" class="text-sm space-y-1"></div>
                </div>
            </div>

            <!-- Process Button -->
            <div class="mt-8 text-center">
                <button id="processBtn" class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-8 py-3 rounded-lg font-semibold text-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                    <i class="fas fa-cogs mr-2"></i>
                    Process Invoice Matching
                </button>
            </div>

            <!-- Progress Bar -->
            <div id="progressContainer" class="mt-6 hidden">
                <div class="bg-gray-200 rounded-full h-3">
                    <div id="progressBar" class="progress-bar bg-gradient-to-r from-indigo-600 to-purple-600 h-3 rounded-full" style="width: 0%"></div>
                </div>
                <p id="progressText" class="text-sm text-gray-600 mt-2 text-center">Processing...</p>
            </div>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="hidden results-section">
            <!-- Statistics Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="stats-card rounded-xl p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-indigo-100">Total Records</p>
                            <p id="totalRecords" class="text-2xl font-bold">0</p>
                        </div>
                        <i class="fas fa-database text-3xl text-indigo-200"></i>
                    </div>
                </div>

                <div class="matched-card rounded-xl p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-pink-100">Matched</p>
                            <p id="matchedRecords" class="text-2xl font-bold">0</p>
                        </div>
                        <i class="fas fa-check-circle text-3xl text-pink-200"></i>
                    </div>
                </div>

                <div class="unmatched-card rounded-xl p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-blue-100">Unmatched</p>
                            <p id="unmatchedRecords" class="text-2xl font-bold">0</p>
                        </div>
                        <i class="fas fa-exclamation-circle text-3xl text-blue-200"></i>
                    </div>
                </div>

                <div class="rate-card rounded-xl p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-green-100">Match Rate</p>
                            <p id="matchRate" class="text-2xl font-bold">0.00%</p>
                        </div>
                        <i class="fas fa-percentage text-3xl text-green-200"></i>
                    </div>
                </div>
            </div>

            <!-- Company Breakdown -->
            <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
                <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-building mr-3 text-indigo-600"></i>
                    Company Breakdown
                </h3>
                <div id="companyBreakdown" class="space-y-4"></div>
            </div>

            <!-- Matching Overview Chart -->
            <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
                <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-chart-pie mr-3 text-indigo-600"></i>
                    Matching Overview
                </h3>
                <div style="height: 400px;">
                    <canvas id="matchingChart"></canvas>
                </div>
            </div>

            <!-- Export Options -->
            <div class="bg-white rounded-xl shadow-lg p-8 mb-8">
                <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                    <i class="fas fa-download mr-3 text-indigo-600"></i>
                    Export Options
                </h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <!-- Matched Exports -->
                    <div class="space-y-3">
                        <h4 class="font-semibold text-green-700 flex items-center">
                            <i class="fas fa-check-circle mr-2"></i>
                            Matched Records
                        </h4>
                        <div class="space-y-2">
                            <button id="exportAllMatched" class="export-btn w-full bg-green-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-green-700">
                                <i class="fas fa-file-excel mr-2"></i>All Matched (Combined Data)
                            </button>
                            <button id="exportPKUMatched" class="export-btn w-full bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-green-600">
                                <i class="fas fa-file-excel mr-2"></i>PKU Matched
                            </button>
                            <button id="exportPRIMatched" class="export-btn w-full bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-green-600">
                                <i class="fas fa-file-excel mr-2"></i>PRI Matched
                            </button>
                            <button id="exportAPDMatched" class="export-btn w-full bg-green-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-green-600 hidden">
                                <i class="fas fa-file-excel mr-2"></i>APD Matched
                            </button>
                        </div>
                    </div>

                    <!-- Unmatched Exports -->
                    <div class="space-y-3">
                        <h4 class="font-semibold text-orange-700 flex items-center">
                            <i class="fas fa-exclamation-circle mr-2"></i>
                            Unmatched Records
                        </h4>
                        <div class="space-y-2">
                            <button id="exportAllUnmatched" class="export-btn w-full bg-orange-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-orange-700">
                                <i class="fas fa-file-excel mr-2"></i>All Unmatched
                            </button>
                            <button id="exportPKUUnmatched" class="export-btn w-full bg-orange-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-orange-600">
                                <i class="fas fa-file-excel mr-2"></i>PKU Unmatched
                            </button>
                            <button id="exportPRIUnmatched" class="export-btn w-full bg-orange-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-orange-600">
                                <i class="fas fa-file-excel mr-2"></i>PRI Unmatched
                            </button>
                            <button id="exportAPDUnmatched" class="export-btn w-full bg-orange-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-orange-600 hidden">
                                <i class="fas fa-file-excel mr-2"></i>APD Unmatched
                            </button>
                        </div>
                    </div>

                    <!-- Summary Reports -->
                    <div class="space-y-3">
                        <h4 class="font-semibold text-blue-700 flex items-center">
                            <i class="fas fa-chart-bar mr-2"></i>
                            Summary Reports
                        </h4>
                        <div class="space-y-2">
                            <button id="exportSummary" class="export-btn w-full bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700">
                                <i class="fas fa-file-alt mr-2"></i>Summary Report
                            </button>
                            <button id="exportCompanyBreakdown" class="export-btn w-full bg-blue-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-600">
                                <i class="fas fa-building mr-2"></i>Company Breakdown
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Data Tables -->
            <div class="space-y-8">
                <!-- Matched Records Table -->
                <div class="bg-white rounded-xl shadow-lg p-8">
                    <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                        <i class="fas fa-check-circle mr-3 text-green-600"></i>
                        Matched Records (Combined Data)
                        <span id="matchedCount" class="ml-3 px-3 py-1 bg-green-100 text-green-800 text-sm rounded-full">0 records</span>
                    </h3>
                    <div class="table-container">
                        <div id="matchedTableContainer" class="overflow-x-auto">
                            <table id="matchedTable" class="min-w-full table-auto">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Company</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Vendor Name</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">NPWP</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Faktur Pajak</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">DPP</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">PPN</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Invoice Company</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Store</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Invoice Number</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Order Number</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Receiving Number</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Confirm Date</th>
                                    </tr>
                                </thead>
                                <tbody id="matchedTableBody" class="bg-white divide-y divide-gray-200">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Unmatched Records Table -->
                <div class="bg-white rounded-xl shadow-lg p-8">
                    <h3 class="text-xl font-bold text-gray-800 mb-6 flex items-center">
                        <i class="fas fa-exclamation-circle mr-3 text-orange-600"></i>
                        Unmatched Records (Requires Follow-up)
                        <span id="unmatchedCount" class="ml-3 px-3 py-1 bg-orange-100 text-orange-800 text-sm rounded-full">0 records</span>
                    </h3>
                    <div class="table-container">
                        <div id="unmatchedTableContainer" class="overflow-x-auto">
                            <table id="unmatchedTable" class="min-w-full table-auto">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Company</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Vendor Name</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">NPWP</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Faktur Pajak</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Masa Pajak</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tahun</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">DPP</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">PPN</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    </tr>
                                </thead>
                                <tbody id="unmatchedTableBody" class="bg-white divide-y divide-gray-200">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success/Error Messages -->
    <div id="messageContainer" class="fixed top-4 right-4 z-50 space-y-2"></div>

    <script>
        // Global variables
        let pkuData = [];
        let priData = [];
        let apdData = [];
        let invoiceData = [];
        let combinedCoretaxData = [];
        let matchedRecords = [];
        let unmatchedRecords = [];
        let companyStats = {};
        let matchingChart = null;

        // File upload handlers
        function setupFileUpload(areaId, inputId, statusId, callback) {
            const area = document.getElementById(areaId);
            const input = document.getElementById(inputId);
            const status = document.getElementById(statusId);
            
            area.addEventListener('click', () => input.click());
            area.addEventListener('dragover', (e) => {
                e.preventDefault();
                area.classList.add('dragover');
            });
            area.addEventListener('dragleave', () => {
                area.classList.remove('dragover');
            });
            area.addEventListener('drop', (e) => {
                e.preventDefault();
                area.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    input.files = files;
                    callback(files);
                }
            });
            input.addEventListener('change', (e) => {
                callback(e.target.files);
            });
        }

        // File processing functions
        function processFile(file, callback) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, {type: 'array'});
                    const sheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, {header: 1});
                    callback(jsonData);
                } catch (error) {
                    showMessage('Error processing file: ' + file.name, 'error');
                    callback(null);
                }
            };
            reader.readAsArrayBuffer(file);
        }

        function cleanFakturPajak(fakturPajak) {
            if (!fakturPajak) return '';
            return String(fakturPajak).replace(/[.\-]/g, '');
        }

        function getLast8Digits(fakturPajak) {
            const cleaned = cleanFakturPajak(fakturPajak);
            return cleaned.slice(-8);
        }

        function filterHermedRecords(data) {
            return data.filter(row => {
                const vendorName = String(row[0] || '').toUpperCase();
                return !vendorName.includes('HERMED');
            });
        }

        function processCoretaxData(data, company, headerRow = 1) {
            const filteredData = filterHermedRecords(data.slice(headerRow));
            return filteredData.map(row => ({
                company: company,
                vendorName: row[0] || '',
                npwp: row[1] || '',
                fakturPajak: row[2] || '',
                date: row[3] || '',
                masaPajak: row[4] || '',
                tahun: row[5] || '',
                hargaDPP: row[9] || 0,
                dppNilaiLain: row[10] || 0,
                ppn: row[11] || 0,
                kodeDiganti: row[13] || '',
                last8Digits: getLast8Digits(row[2])
            })).filter(record => record.last8Digits.length > 0);
        }

        function processInvoiceData(dataArrays) {
            const combined = [];
            dataArrays.forEach(data => {
                const processedData = data.slice(3).map(row => ({
                    invoiceCompany: row[0] || '',
                    store: row[1] || '',
                    confirmDate: row[8] || '',
                    invoiceNumber: row[9] || '',
                    fakturPajak: row[10] || '',
                    orderNumber: row[13] || '',
                    receivingNumber: row[14] || '',
                    totalInvoiceTaxAmount: row[17] || '', 
                    last8Digits: getLast8Digits(row[10])
                })).filter(record => record.last8Digits.length > 0);
                combined.push(...processedData);
            });
            return combined;
        }

        function performMatching() {
            // Create hash map for efficient lookup
            const invoiceMap = new Map();
            invoiceData.forEach(invoice => {
                if (invoice.last8Digits) {
                    invoiceMap.set(invoice.last8Digits, invoice);
                }
            });

            matchedRecords = [];
            unmatchedRecords = [];

            combinedCoretaxData.forEach(coretax => {
                const matchingInvoice = invoiceMap.get(coretax.last8Digits);
                if (matchingInvoice) {
                    matchedRecords.push({
                        ...coretax,
                        matchingInvoice: matchingInvoice
                    });
                } else {
                    unmatchedRecords.push(coretax);
                }
            });

            // Calculate company statistics
            companyStats = {
                PKU: { total: 0, matched: 0, unmatched: 0 },
                PRI: { total: 0, matched: 0, unmatched: 0 },
                APD: { total: 0, matched: 0, unmatched: 0 }
            };

            combinedCoretaxData.forEach(record => {
                if (companyStats[record.company]) {
                    companyStats[record.company].total++;
                }
            });

            matchedRecords.forEach(record => {
                if (companyStats[record.company]) {
                    companyStats[record.company].matched++;
                }
            });

            unmatchedRecords.forEach(record => {
                if (companyStats[record.company]) {
                    companyStats[record.company].unmatched++;
                }
            });
        }

        function displayResults() {
            const totalRecords = combinedCoretaxData.length;
            const matchedCount = matchedRecords.length;
            const unmatchedCount = unmatchedRecords.length;
            const matchRate = totalRecords > 0 ? ((matchedCount / totalRecords) * 100).toFixed(2) : '0.00';

            // Update statistics cards
            document.getElementById('totalRecords').textContent = totalRecords.toLocaleString();
            document.getElementById('matchedRecords').textContent = matchedCount.toLocaleString();
            document.getElementById('unmatchedRecords').textContent = unmatchedCount.toLocaleString();
            document.getElementById('matchRate').textContent = matchRate + '%';

            // Update counts in table headers
            document.getElementById('matchedCount').textContent = `${matchedCount.toLocaleString()} records`;
            document.getElementById('unmatchedCount').textContent = `${unmatchedCount.toLocaleString()} records`;

            // Display company breakdown
            displayCompanyBreakdown();

            // Display matching chart
            displayMatchingChart();

            // Display data tables
            displayMatchedTable();
            displayUnmatchedTable();

            // Show/hide APD export buttons
            const apdHasData = companyStats.APD.total > 0;
            document.getElementById('exportAPDMatched').classList.toggle('hidden', !apdHasData);
            document.getElementById('exportAPDUnmatched').classList.toggle('hidden', !apdHasData);

            // Show results section
            document.getElementById('resultsSection').classList.remove('hidden');
        }

        function displayCompanyBreakdown() {
            const container = document.getElementById('companyBreakdown');
            container.innerHTML = '';

            Object.entries(companyStats).forEach(([company, stats]) => {
                if (stats.total > 0) {
                    const matchRate = ((stats.matched / stats.total) * 100).toFixed(2);
                    const div = document.createElement('div');
                    div.className = 'flex items-center justify-between p-4 bg-gray-50 rounded-lg';
                    div.innerHTML = `
                        <div class="flex items-center">
                            <span class="company-tag px-3 py-1 rounded-full text-white ${
                                company === 'PKU' ? 'bg-green-600' : 
                                company === 'PRI' ? 'bg-blue-600' : 'bg-purple-600'
                            }">${company}</span>
                            <div class="ml-4">
                                <p class="font-medium text-gray-900">Records: ${stats.total.toLocaleString()}</p>
                                <p class="text-sm text-gray-600">Matched: ${stats.matched.toLocaleString()} | Unmatched: ${stats.unmatched.toLocaleString()}</p>
                            </div>
                        </div>
                        <div class="text-right">
                            <p class="text-lg font-bold text-gray-900">${matchRate}%</p>
                            <p class="text-sm text-gray-600">Match Rate</p>
                        </div>
                    `;
                    container.appendChild(div);
                }
            });
        }

        function displayMatchingChart() {
            const ctx = document.getElementById('matchingChart').getContext('2d');
            
            if (matchingChart) {
                matchingChart.destroy();
            }

            matchingChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Matched', 'Unmatched'],
                    datasets: [{
                        data: [matchedRecords.length, unmatchedRecords.length],
                        backgroundColor: ['#10b981', '#f59e0b'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                padding: 20
                            }
                        }
                    }
                }
            });
        }

        function displayMatchedTable() {
            const tbody = document.getElementById('matchedTableBody');
            tbody.innerHTML = '';

            matchedRecords.slice(0, 100).forEach(record => { // Show first 100 for PDF optimization
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                row.innerHTML = `
                    <td class="px-4 py-3 whitespace-nowrap">
                        <span class="company-tag px-2 py-1 rounded-full text-white text-xs ${
                            record.company === 'PKU' ? 'bg-green-600' : 
                            record.company === 'PRI' ? 'bg-blue-600' : 'bg-purple-600'
                        }">${record.company}</span>
                    </td>
                    <td class="px-4 py-3 text-sm text-gray-900">${record.vendorName}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${record.npwp}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${record.fakturPajak}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${record.date}</td>
                    <td class="px-4 py-3 text-sm text-gray-900">${Number(record.hargaDPP).toLocaleString()}</td>
                    <td class="px-4 py-3 text-sm text-gray-900">${Number(record.ppn).toLocaleString()}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${record.matchingInvoice?.invoiceCompany || ''}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${record.matchingInvoice?.store || ''}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${record.matchingInvoice?.invoiceNumber || ''}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${record.matchingInvoice?.orderNumber || ''}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${record.matchingInvoice?.receivingNumber || ''}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${record.matchingInvoice?.confirmDate || ''}</td>
                `;
                tbody.appendChild(row);
            });

            if (matchedRecords.length > 100) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td colspan="13" class="px-4 py-3 text-center text-sm text-gray-500">
                        Showing first 100 records. Export for complete data.
                    </td>
                `;
                tbody.appendChild(row);
            }
        }

        function displayUnmatchedTable() {
            const tbody = document.getElementById('unmatchedTableBody');
            tbody.innerHTML = '';

            unmatchedRecords.slice(0, 100).forEach(record => { // Show first 100 for PDF optimization
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                row.innerHTML = `
                    <td class="px-4 py-3 whitespace-nowrap">
                        <span class="company-tag px-2 py-1 rounded-full text-white text-xs ${
                            record.company === 'PKU' ? 'bg-green-600' : 
                            record.company === 'PRI' ? 'bg-blue-600' : 'bg-purple-600'
                        }">${record.company}</span>
                    </td>
                    <td class="px-4 py-3 text-sm text-gray-900">${record.vendorName}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${record.npwp}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${record.fakturPajak}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${record.date}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${record.masaPajak}</td>
                    <td class="px-4 py-3 text-sm text-gray-600">${record.tahun}</td>
                    <td class="px-4 py-3 text-sm text-gray-900">${Number(record.hargaDPP).toLocaleString()}</td>
                    <td class="px-4 py-3 text-sm text-gray-900">${Number(record.ppn).toLocaleString()}</td>
                    <td class="px-4 py-3 whitespace-nowrap">
                        <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-orange-100 text-orange-800">
                            Unmatched
                        </span>
                    </td>
                `;
                tbody.appendChild(row);
            });

            if (unmatchedRecords.length > 100) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td colspan="10" class="px-4 py-3 text-center text-sm text-gray-500">
                        Showing first 100 records. Export for complete data.
                    </td>
                `;
                tbody.appendChild(row);
            }
        }

        function exportToExcel(data, filename, headers) {
            const worksheet = XLSX.utils.json_to_sheet(data);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 'Data');
            XLSX.writeFile(workbook, filename);
        }

        function showMessage(message, type = 'success') {
            const container = document.getElementById('messageContainer');
            const div = document.createElement('div');
            div.className = `p-4 rounded-lg shadow-lg ${
                type === 'success' ? 'bg-green-100 text-green-800 border border-green-200' : 
                'bg-red-100 text-red-800 border border-red-200'
            }`;
            div.innerHTML = `
                <div class="flex items-center">
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'} mr-2"></i>
                    ${message}
                </div>
            `;
            container.appendChild(div);
            setTimeout(() => div.remove(), 5000);
        }

        function updateProgress(percent, text) {
            document.getElementById('progressBar').style.width = percent + '%';
            document.getElementById('progressText').textContent = text;
        }

        function checkProcessButton() {
            const pkuUploaded = pkuData.length > 0;
            const priUploaded = priData.length > 0;
            const invoiceUploaded = invoiceData.length > 0;
            
            document.getElementById('processBtn').disabled = !(pkuUploaded && priUploaded && invoiceUploaded);
        }

        // Initialize file uploads
        setupFileUpload('pkuUploadArea', 'pkuFile', 'pkuStatus', (files) => {
            if (files.length > 0) {
                document.getElementById('pkuStatus').innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Processing...';
                processFile(files[0], (data) => {
                    if (data) {
                        pkuData = processCoretaxData(data, 'PKU', 1);
                        document.getElementById('pkuStatus').innerHTML = `<i class="fas fa-check-circle text-green-600 mr-2"></i>PKU file loaded: ${pkuData.length.toLocaleString()} records`;
                        checkProcessButton();
                    } else {
                        document.getElementById('pkuStatus').innerHTML = '<i class="fas fa-times-circle text-red-600 mr-2"></i>Error loading file';
                    }
                });
            }
        });

        setupFileUpload('priUploadArea', 'priFile', 'priStatus', (files) => {
            if (files.length > 0) {
                document.getElementById('priStatus').innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Processing...';
                processFile(files[0], (data) => {
                    if (data) {
                        priData = processCoretaxData(data, 'PRI', 2);
                        document.getElementById('priStatus').innerHTML = `<i class="fas fa-check-circle text-blue-600 mr-2"></i>PRI file loaded: ${priData.length.toLocaleString()} records`;
                        checkProcessButton();
                    } else {
                        document.getElementById('priStatus').innerHTML = '<i class="fas fa-times-circle text-red-600 mr-2"></i>Error loading file';
                    }
                });
            }
        });

        setupFileUpload('apdUploadArea', 'apdFile', 'apdStatus', (files) => {
            if (files.length > 0) {
                document.getElementById('apdStatus').innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Processing...';
                processFile(files[0], (data) => {
                    if (data) {
                        apdData = processCoretaxData(data, 'APD', 1);
                        document.getElementById('apdStatus').innerHTML = `<i class="fas fa-check-circle text-purple-600 mr-2"></i>APD file loaded: ${apdData.length.toLocaleString()} records`;
                    } else {
                        document.getElementById('apdStatus').innerHTML = '<i class="fas fa-times-circle text-red-600 mr-2"></i>Error loading file';
                        apdData = [];
                    }
                });
            }
        });

        setupFileUpload('invoiceUploadArea', 'invoiceFiles', 'invoiceStatus', (files) => {
            if (files.length > 0) {
                const statusContainer = document.getElementById('invoiceStatus');
                statusContainer.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Processing multiple files...';
                
                let processedFiles = 0;
                const allInvoiceData = [];
                
                Array.from(files).forEach((file, index) => {
                    processFile(file, (data) => {
                        processedFiles++;
                        if (data) {
                            allInvoiceData.push(data);
                        }
                        
                        if (processedFiles === files.length) {
                            invoiceData = processInvoiceData(allInvoiceData);
                            statusContainer.innerHTML = `
                                <i class="fas fa-check-circle text-orange-600 mr-2"></i>${files.length} invoice files loaded: ${invoiceData.length.toLocaleString()} total records
                                <div class="mt-1 space-y-1">
                                    ${Array.from(files).map((f, i) => `<div class="text-xs text-gray-600"><i class="fas fa-file mr-1"></i>${f.name}</div>`).join('')}
                                </div>
                            `;
                            checkProcessButton();
                        }
                    });
                });
            }
        });

        // Process button handler
        document.getElementById('processBtn').addEventListener('click', async () => {
            document.getElementById('progressContainer').classList.remove('hidden');
            document.getElementById('processBtn').disabled = true;
            
            try {
                updateProgress(10, 'Combining CoreTax data...');
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Combine all CoreTax data
                combinedCoretaxData = [...pkuData, ...priData, ...apdData];
                
                updateProgress(30, 'Processing Invoice Matching data...');
                await new Promise(resolve => setTimeout(resolve, 500));
                
                updateProgress(50, 'Performing matching analysis...');
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Perform matching
                performMatching();
                
                updateProgress(80, 'Generating results...');
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Display results
                displayResults();
                
                updateProgress(100, 'Processing complete!');
                setTimeout(() => {
                    document.getElementById('progressContainer').classList.add('hidden');
                }, 1000);
                
                showMessage('Invoice matching completed successfully!');
                
            } catch (error) {
                showMessage('Processing failed: ' + error.message, 'error');
                document.getElementById('progressContainer').classList.add('hidden');
            } finally {
                document.getElementById('processBtn').disabled = false;
            }
        });

        // Export button handlers
        document.getElementById('exportAllMatched').addEventListener('click', () => {
            const exportData = matchedRecords.map(record => ({
                'Company': record.company,
                'Vendor Name': record.vendorName,
                'NPWP': record.npwp,
                'Faktur Pajak': record.fakturPajak,
                'Date': record.date,
                'Masa Pajak': record.masaPajak,
                'Tahun': record.tahun,
                'Harga DPP': record.hargaDPP,
                'DPP Nilai Lain': record.dppNilaiLain,
                'PPN': record.ppn,
                'Kode Diganti': record.kodeDiganti,
                'Invoice Company': record.matchingInvoice?.invoiceCompany || '',
                'Store': record.matchingInvoice?.store || '', 
                'Confirm Date': record.matchingInvoice?.confirmDate || '',
                'Invoice Number': record.matchingInvoice?.invoiceNumber || '',
                'Order Number': record.matchingInvoice?.orderNumber || '',
                'Receiving Number': record.matchingInvoice?.receivingNumber || ''
                'Total Invoice Tax Amount': record.matchingInvoice?.totalInvoiceTaxAmount || ''
            }));
            exportToExcel(exportData, 'All_Matched_Records_Combined.xlsx');
            showMessage('All matched records exported successfully!');
        });

        document.getElementById('exportPKUMatched').addEventListener('click', () => {
            const pkuMatched = matchedRecords.filter(record => record.company === 'PKU');
            const exportData = pkuMatched.map(record => ({
                'Company': record.company,
                'Vendor Name': record.vendorName,
                'NPWP': record.npwp,
                'Faktur Pajak': record.fakturPajak,
                'Date': record.date,
                'Masa Pajak': record.masaPajak,
                'Tahun': record.tahun,
                'Harga DPP': record.hargaDPP,
                'DPP Nilai Lain': record.dppNilaiLain,
                'PPN': record.ppn,
                'Kode Diganti': record.kodeDiganti,
                'Invoice Company': record.matchingInvoice?.invoiceCompany || '',
                'Store': record.matchingInvoice?.store || '',
                'Confirm Date': record.matchingInvoice?.confirmDate || '',
                'Invoice Number': record.matchingInvoice?.invoiceNumber || '',
                'Order Number': record.matchingInvoice?.orderNumber || '',
                'Receiving Number': record.matchingInvoice?.receivingNumber || ''
            }));
            exportToExcel(exportData, 'PKU_Matched_Records_Combined.xlsx');
            showMessage('PKU matched records exported successfully!');
        });

        document.getElementById('exportPRIMatched').addEventListener('click', () => {
            const priMatched = matchedRecords.filter(record => record.company === 'PRI');
            const exportData = priMatched.map(record => ({
                'Company': record.company,
                'Vendor Name': record.vendorName,
                'NPWP': record.npwp,
                'Faktur Pajak': record.fakturPajak,
                'Date': record.date,
                'Masa Pajak': record.masaPajak,
                'Tahun': record.tahun,
                'Harga DPP': record.hargaDPP,
                'DPP Nilai Lain': record.dppNilaiLain,
                'PPN': record.ppn,
                'Kode Diganti': record.kodeDiganti,
                'Invoice Company': record.matchingInvoice?.invoiceCompany || '',
                'Store': record.matchingInvoice?.store || '',
                'Confirm Date': record.matchingInvoice?.confirmDate || '',
                'Invoice Number': record.matchingInvoice?.invoiceNumber || '',
                'Order Number': record.matchingInvoice?.orderNumber || '',
                'Receiving Number': record.matchingInvoice?.receivingNumber || ''
            }));
            exportToExcel(exportData, 'PRI_Matched_Records_Combined.xlsx');
            showMessage('PRI matched records exported successfully!');
        });

        document.getElementById('exportAPDMatched').addEventListener('click', () => {
            const apdMatched = matchedRecords.filter(record => record.company === 'APD');
            const exportData = apdMatched.map(record => ({
                'Company': record.company,
                'Vendor Name': record.vendorName,
                'NPWP': record.npwp,
                'Faktur Pajak': record.fakturPajak,
                'Date': record.date,
                'Masa Pajak': record.masaPajak,
                'Tahun': record.tahun,
                'Harga DPP': record.hargaDPP,
                'DPP Nilai Lain': record.dppNilaiLain,
                'PPN': record.ppn,
                'Kode Diganti': record.kodeDiganti,
                'Invoice Company': record.matchingInvoice?.invoiceCompany || '',
                'Store': record.matchingInvoice?.store || '',
                'Confirm Date': record.matchingInvoice?.confirmDate || '',
                'Invoice Number': record.matchingInvoice?.invoiceNumber || '',
                'Order Number': record.matchingInvoice?.orderNumber || '',
                'Receiving Number': record.matchingInvoice?.receivingNumber || ''
            }));
            exportToExcel(exportData, 'APD_Matched_Records_Combined.xlsx');
            showMessage('APD matched records exported successfully!');
        });

        document.getElementById('exportAllUnmatched').addEventListener('click', () => {
            const exportData = unmatchedRecords.map(record => ({
                'Company': record.company,
                'Vendor Name': record.vendorName,
                'NPWP': record.npwp,
                'Faktur Pajak': record.fakturPajak,
                'Date': record.date,
                'Masa Pajak': record.masaPajak,
                'Tahun': record.tahun,
                'Harga DPP': record.hargaDPP,
                'DPP Nilai Lain': record.dppNilaiLain,
                'PPN': record.ppn,
                'Kode Diganti': record.kodeDiganti,
                'Status': 'Unmatched - Requires Follow-up'
            }));
            exportToExcel(exportData, 'All_Unmatched_Records.xlsx');
            showMessage('All unmatched records exported successfully!');
        });

        document.getElementById('exportPKUUnmatched').addEventListener('click', () => {
            const pkuUnmatched = unmatchedRecords.filter(record => record.company === 'PKU');
            const exportData = pkuUnmatched.map(record => ({
                'Company': record.company,
                'Vendor Name': record.vendorName,
                'NPWP': record.npwp,
                'Faktur Pajak': record.fakturPajak,
                'Date': record.date,
                'Masa Pajak': record.masaPajak,
                'Tahun': record.tahun,
                'Harga DPP': record.hargaDPP,
                'DPP Nilai Lain': record.dppNilaiLain,
                'PPN': record.ppn,
                'Kode Diganti': record.kodeDiganti,
                'Status': 'Unmatched - Requires Follow-up'
            }));
            exportToExcel(exportData, 'PKU_Unmatched_Records.xlsx');
            showMessage('PKU unmatched records exported successfully!');
        });

        document.getElementById('exportPRIUnmatched').addEventListener('click', () => {
            const priUnmatched = unmatchedRecords.filter(record => record.company === 'PRI');
            const exportData = priUnmatched.map(record => ({
                'Company': record.company,
                'Vendor Name': record.vendorName,
                'NPWP': record.npwp,
                'Faktur Pajak': record.fakturPajak,
                'Date': record.date,
                'Masa Pajak': record.masaPajak,
                'Tahun': record.tahun,
                'Harga DPP': record.hargaDPP,
                'DPP Nilai Lain': record.dppNilaiLain,
                'PPN': record.ppn,
                'Kode Diganti': record.kodeDiganti,
                'Status': 'Unmatched - Requires Follow-up'
            }));
            exportToExcel(exportData, 'PRI_Unmatched_Records.xlsx');
            showMessage('PRI unmatched records exported successfully!');
        });

        document.getElementById('exportAPDUnmatched').addEventListener('click', () => {
            const apdUnmatched = unmatchedRecords.filter(record => record.company === 'APD');
            const exportData = apdUnmatched.map(record => ({
                'Company': record.company,
                'Vendor Name': record.vendorName,
                'NPWP': record.npwp,
                'Faktur Pajak': record.fakturPajak,
                'Date': record.date,
                'Masa Pajak': record.masaPajak,
                'Tahun': record.tahun,
                'Harga DPP': record.hargaDPP,
                'DPP Nilai Lain': record.dppNilaiLain,
                'PPN': record.ppn,
                'Kode Diganti': record.kodeDiganti,
                'Status': 'Unmatched - Requires Follow-up'
            }));
            exportToExcel(exportData, 'APD_Unmatched_Records.xlsx');
            showMessage('APD unmatched records exported successfully!');
        });

        document.getElementById('exportSummary').addEventListener('click', () => {
            const summaryData = [
                {
                    'Metric': 'Total Records',
                    'Value': combinedCoretaxData.length,
                    'Description': 'Total records processed from all CoreTax files'
                },
                {
                    'Metric': 'Matched Records',
                    'Value': matchedRecords.length,
                    'Description': 'Successfully matched with Invoice data'
                },
                {
                    'Metric': 'Unmatched Records',
                    'Value': unmatchedRecords.length,
                    'Description': 'Require follow-up action'
                },
                {
                    'Metric': 'Match Rate',
                    'Value': ((matchedRecords.length / combinedCoretaxData.length) * 100).toFixed(2) + '%',
                    'Description': 'Percentage of successful matches'
                }
            ];
            exportToExcel(summaryData, 'Summary_Report.xlsx');
            showMessage('Summary report exported successfully!');
        });

        document.getElementById('exportCompanyBreakdown').addEventListener('click', () => {
            const companyData = Object.entries(companyStats).map(([company, stats]) => ({
                'Company': company,
                'Total Records': stats.total,
                'Matched Records': stats.matched,
                'Unmatched Records': stats.unmatched,
                'Match Rate': stats.total > 0 ? ((stats.matched / stats.total) * 100).toFixed(2) + '%' : '0.00%'
            })).filter(item => item['Total Records'] > 0);
            exportToExcel(companyData, 'Company_Breakdown.xlsx');
            showMessage('Company breakdown exported successfully!');
        });
    </script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"9562f3738dbffd26","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.6.2","token":"4edd5f8ec12a48cfa682ab8261b80a79"}' crossorigin="anonymous"></script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDv8GF6eD8D2HysyxDGpnxCGomn7WKtX0%2B3Thi7rL5NVhCkXTyMukmsSMn94ElKUAeADBDTmRXqVSI3KpE9A8ovfssGp2F652XtUz2NRuCgPvc%2Br3OVAtSDJFdlGqHTfPHIIQtR03tvN2VPFxvXKbLDFuVCl32dza8RrcxIGHd%2FzErQSM4DVuRKF8Tsxl8752oJgioLSVXksrYPI96A0SKUWVRn72wEhym32bX9zXBEkI2aLcEa%2FnzZE1FQ7b%2F%2FI6LsW%2B7U7ntQqElUJEAmqS7QawTmhaeMgwRUb8yNKWXGfmQwIeSvkfvs%2B0FSGUwMnociySx%2BWXhTHvdqCbsSpa1YLBgLXpOIAGfe8kpQZbZewxMMAAwvyY2OhCDzyKU8bMNBzX4lQcb%2FKLD3wpfFvfrMMYpcz%2BjfR%2BZFA5cRvnMgZGE%2BskDrOmtL%2Fcg6kyljSvtNoii4deimj8u5%2BeqG2EHBlBxMY%2ByDkcs%2FeIbtvpRqR%2F8vhdTKb49%2BkG17W41HlE8Xd4VWw1%2FaUL55oE9w85hL%2FLLQBLCAT8gAqh3TTNQYCO";
        window.__genspark_locale = "en-US";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDv8GF6eD8D2HysyxDGpnxCGomn7WKtX0+3Thi7rL5NVhCkXTyMukmsSMn94ElKUAeADBDTmRXqVSI3KpE9A8ovfssGp2F652XtUz2NRuCgPvc+r3OVAtSDJFdlGqHTfPHIIQtR03tvN2VPFxvXKbLDFuVCl32dza8RrcxIGHd/zErQSM4DVuRKF8Tsxl8752oJgioLSVXksrYPI96A0SKUWVRn72wEhym32bX9zXBEkI2aLcEa/nzZE1FQ7b//I6LsW+7U7ntQqElUJEAmqS7QawTmhaeMgwRUb8yNKWXGfmQwIeSvkfvs+0FSGUwMnociySx+WXhTHvdqCbsSpa1YLBgLXpOIAGfe8kpQZbZewxMMAAwvyY2OhCDzyKU8bMNBzX4lQcb/KLD3wpfFvfrMMYpcz+jfR+ZFA5cRvnMgZGE+skDrOmtL/cg6kyljSvtNoii4deimj8u5+eqG2EHBlBxMY+yDkcs/eIbtvpRqR/8vhdTKb49+kG17W41HlE8Xd4VWw1/aUL55oE9w85hL/LLQBLCAT8gAqh3TTNQYCO";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    
