<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apotek Alpro - Executive Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .subtab-content { display: none; }
        .subtab-content.active { display: block; }
        .loading { display: none; }
        .loading.show { display: flex; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .medical-gradient { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .iframe-container { position: relative; width: 100%; height: 600px; }
        .iframe-error { display: none; }
        .iframe-error.show { display: block; }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Login Screen -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center medical-gradient">
        <div class="bg-white p-8 rounded-lg shadow-2xl w-full max-w-md">
            <div class="text-center mb-8">
                <i class="fas fa-hospital-alt text-4xl text-blue-600 mb-4"></i>
                <h1 class="text-2xl font-bold text-gray-800">Apotek Alpro</h1>
                <p class="text-gray-600">Executive Dashboard</p>
            </div>
            
            <form id="loginForm" class="space-y-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fas fa-user mr-2"></i>Email/Username
                    </label>
                    <input type="text" id="username" required 
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fas fa-lock mr-2"></i>Password
                    </label>
                    <input type="password" id="password" required 
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                
                <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-200">
                    <i class="fas fa-sign-in-alt mr-2"></i>Login
                </button>
            </form>
            
            <div id="loginError" class="hidden mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded"></div>
            <div id="loginLoading" class="hidden mt-4 text-center">
                <i class="fas fa-spinner fa-spin text-blue-600"></i>
                <span class="ml-2 text-gray-600">Authenticating...</span>
            </div>
        </div>
    </div>

    <!-- Main Dashboard -->
    <div id="dashboard" class="hidden min-h-screen bg-gray-50">
        <!-- Header -->
        <header class="bg-white shadow-sm border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center">
                        <i class="fas fa-hospital-alt text-2xl text-blue-600 mr-3"></i>
                        <h1 class="text-xl font-semibold text-gray-900">Apotek Alpro Executive Dashboard</h1>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center">
                            <span id="userRole" class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium"></span>
                            <span id="userName" class="ml-3 text-sm text-gray-700"></span>
                        </div>
                        <button id="logoutBtn" class="text-gray-500 hover:text-gray-700">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="bg-white border-b">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex space-x-8" id="mainTabs">
                    <!-- Tabs will be generated dynamically based on user role -->
                </div>
            </div>
        </nav>

        <!-- Tab Content -->
        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <!-- Overview Tab -->
            <div id="overview" class="tab-content">
                <div class="bg-white rounded-lg shadow p-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">Executive Overview</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <div class="flex items-center">
                                <i class="fas fa-chart-line text-blue-600 text-2xl mr-3"></i>
                                <div>
                                    <p class="text-sm text-gray-600">Performance</p>
                                    <p class="text-xl font-semibold text-gray-900">Excellent</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg">
                            <div class="flex items-center">
                                <i class="fas fa-users text-green-600 text-2xl mr-3"></i>
                                <div>
                                    <p class="text-sm text-gray-600">Active Users</p>
                                    <p class="text-xl font-semibold text-gray-900">24/7</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-yellow-50 p-4 rounded-lg">
                            <div class="flex items-center">
                                <i class="fas fa-tasks text-yellow-600 text-2xl mr-3"></i>
                                <div>
                                    <p class="text-sm text-gray-600">Systems</p>
                                    <p class="text-xl font-semibold text-gray-900">Online</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <div class="flex items-center">
                                <i class="fas fa-shield-alt text-purple-600 text-2xl mr-3"></i>
                                <div>
                                    <p class="text-sm text-gray-600">Security</p>
                                    <p class="text-xl font-semibold text-gray-900">Secure</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PPM Tab -->
            <div id="ppm" class="tab-content">
                <div class="bg-white rounded-lg shadow p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">PPM Dashboard</h2>
                        <button onclick="refreshPPM()" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700">
                            <i class="fas fa-sync-alt mr-2"></i>Refresh
                        </button>
                    </div>
                    <div class="iframe-container">
                        <iframe id="ppmIframe" 
                                src="https://script.google.com/macros/s/AKfycbzaRaZPlsmOGgKRGssxuMPvYx9FQabDshXkwkfkJyIpoZQ4OHz7TYr7wtccK2DAnlho/exec"
                                class="w-full h-full border-0 rounded-lg"
                                loading="lazy">
                        </iframe>
                        <div class="iframe-error bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-4">
                            <div class="flex items-center">
                                <i class="fas fa-exclamation-triangle text-yellow-600 mr-3"></i>
                                <div>
                                    <p class="text-sm text-yellow-800">Unable to embed dashboard. Please use the direct link below:</p>
                                    <a href="https://script.google.com/macros/s/AKfycbzaRaZPlsmOGgKRGssxuMPvYx9FQabDshXkwkfkJyIpoZQ4OHz7TYr7wtccK2DAnlho/exec" 
                                       target="_blank" 
                                       class="inline-flex items-center mt-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700">
                                        <i class="fas fa-external-link-alt mr-2"></i>Open PPM Dashboard
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Finance Tab -->
            <div id="finance" class="tab-content">
                <div class="bg-white rounded-lg shadow">
                    <!-- Finance Sub-navigation -->
                    <div class="border-b">
                        <nav class="flex space-x-8 px-6 pt-6">
                            <button class="finance-subtab pb-2 px-1 border-b-2 border-blue-500 text-blue-600 font-medium" data-target="coretax">
                                <i class="fas fa-file-invoice mr-2"></i>Coretax - Invoice Matching System
                            </button>
                            <button class="finance-subtab pb-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-target="reports">
                                <i class="fas fa-chart-bar mr-2"></i>Financial Reports
                            </button>
                            <button class="finance-subtab pb-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-target="budget">
                                <i class="fas fa-calculator mr-2"></i>Budget Analysis
                            </button>
                            <button class="finance-subtab pb-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-target="revenue">
                                <i class="fas fa-money-bill-wave mr-2"></i>Revenue Dashboard
                            </button>
                        </nav>
                    </div>

                    <!-- Finance Subtab Contents -->
                    <div class="p-6">
                        <!-- Coretax Subtab -->
                        <div id="coretax" class="subtab-content active">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-xl font-bold text-gray-900">
                                    <i class="fas fa-file-invoice text-blue-600 mr-2"></i>Coretax - Invoice Matching System
                                </h3>
                                <div class="flex space-x-2">
                                    <button onclick="refreshCoretax()" class="bg-blue-600 text-white px-3 py-1 rounded-md hover:bg-blue-700 text-sm">
                                        <i class="fas fa-sync-alt mr-1"></i>Refresh
                                    </button>
                                    <a href="https://bsnpklin.gensparkspace.com/" target="_blank" 
                                       class="bg-green-600 text-white px-3 py-1 rounded-md hover:bg-green-700 text-sm">
                                        <i class="fas fa-external-link-alt mr-1"></i>Open in New Tab
                                    </a>
                                </div>
                            </div>
                            
                            <div class="iframe-container">
                                <iframe id="coretaxIframe" 
                                        src="https://bsnpklin.gensparkspace.com/"
                                        class="w-full h-full border-0 rounded-lg shadow-inner"
                                        loading="lazy"
                                        onload="handleIframeLoad('coretax')"
                                        onerror="handleIframeError('coretax')">
                                </iframe>
                                <div id="coretaxError" class="iframe-error bg-yellow-50 border border-yellow-200 rounded-lg p-6">
                                    <div class="text-center">
                                        <i class="fas fa-exclamation-triangle text-yellow-600 text-3xl mb-4"></i>
                                        <h4 class="text-lg font-semibold text-yellow-800 mb-2">Unable to Embed System</h4>
                                        <p class="text-sm text-yellow-700 mb-4">The Coretax system cannot be embedded due to security restrictions.</p>
                                        <div class="flex justify-center space-x-4">
                                            <a href="https://bsnpklin.gensparkspace.com/" target="_blank" 
                                               class="inline-flex items-center bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition duration-200">
                                                <i class="fas fa-external-link-alt mr-2"></i>Open Coretax System
                                            </a>
                                            <button onclick="retryCoretaxEmbed()" 
                                                    class="inline-flex items-center bg-gray-600 text-white px-6 py-3 rounded-md hover:bg-gray-700 transition duration-200">
                                                <i class="fas fa-redo mr-2"></i>Retry Embed
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Other Finance Subtabs -->
                        <div id="reports" class="subtab-content">
                            <div class="text-center py-12">
                                <i class="fas fa-chart-bar text-4xl text-gray-400 mb-4"></i>
                                <h3 class="text-xl font-semibold text-gray-900 mb-2">Financial Reports</h3>
                                <p class="text-gray-600 mb-6">Connect your financial reporting system here</p>
                                <button class="bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700">
                                    <i class="fas fa-plus mr-2"></i>Add Integration
                                </button>
                            </div>
                        </div>

                        <div id="budget" class="subtab-content">
                            <div class="text-center py-12">
                                <i class="fas fa-calculator text-4xl text-gray-400 mb-4"></i>
                                <h3 class="text-xl font-semibold text-gray-900 mb-2">Budget Analysis</h3>
                                <p class="text-gray-600 mb-6">Connect your budget analysis tools here</p>
                                <button class="bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700">
                                    <i class="fas fa-plus mr-2"></i>Add Integration
                                </button>
                            </div>
                        </div>

                        <div id="revenue" class="subtab-content">
                            <div class="text-center py-12">
                                <i class="fas fa-money-bill-wave text-4xl text-gray-400 mb-4"></i>
                                <h3 class="text-xl font-semibold text-gray-900 mb-2">Revenue Dashboard</h3>
                                <p class="text-gray-600 mb-6">Connect your revenue tracking system here</p>
                                <button class="bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700">
                                    <i class="fas fa-plus mr-2"></i>Add Integration
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Other Department Tabs -->
            <div id="operations" class="tab-content">
                <div class="bg-white rounded-lg shadow p-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">Operations Dashboard</h2>
                    <div class="text-center py-12">
                        <i class="fas fa-cogs text-4xl text-gray-400 mb-4"></i>
                        <p class="text-gray-600 mb-6">Connect your operations dashboard here</p>
                        <button class="bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700">
                            <i class="fas fa-plus mr-2"></i>Add Integration
                        </button>
                    </div>
                </div>
            </div>

            <div id="bpt" class="tab-content">
                <div class="bg-white rounded-lg shadow p-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">BPT Dashboard</h2>
                    <div class="text-center py-12">
                        <i class="fas fa-project-diagram text-4xl text-gray-400 mb-4"></i>
                        <p class="text-gray-600 mb-6">Connect your BPT system here</p>
                        <button class="bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700">
                            <i class="fas fa-plus mr-2"></i>Add Integration
                        </button>
                    </div>
                </div>
            </div>

            <div id="academy" class="tab-content">
                <div class="bg-white rounded-lg shadow p-6">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">Academy Dashboard</h2>
                    <div class="text-center py-12">
                        <i class="fas fa-graduation-cap text-4xl text-gray-400 mb-4"></i>
                        <p class="text-gray-600 mb-6">Connect your academy system here</p>
                        <button class="bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700">
                            <i class="fas fa-plus mr-2"></i>Add Integration
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        let currentUser = null;
        let userRole = null;

        // Role-based tab configuration
        const rolePermissions = {
            'admin': ['overview', 'ppm', 'finance', 'operations', 'bpt', 'academy'],
            'chief': ['overview', 'ppm', 'finance', 'operations', 'bpt', 'academy'],
            'ppm': ['ppm'],
            'finance': ['finance'],
            'operations': ['operations'],
            'bpt': ['bpt'],
            'academy': ['academy']
        };

        const tabIcons = {
            'overview': 'fas fa-tachometer-alt',
            'ppm': 'fas fa-chart-line',
            'finance': 'fas fa-dollar-sign',
            'operations': 'fas fa-cogs',
            'bpt': 'fas fa-project-diagram',
            'academy': 'fas fa-graduation-cap'
        };

        const tabNames = {
            'overview': 'Overview',
            'ppm': 'PPM',
            'finance': 'Finance',
            'operations': 'Operations',
            'bpt': 'BPT',
            'academy': 'Academy'
        };

        // Authentication
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const loginError = document.getElementById('loginError');
            const loginLoading = document.getElementById('loginLoading');
            
            loginError.classList.add('hidden');
            loginLoading.classList.remove('hidden');
            
            try {
                const response = await fetch('https://docs.google.com/spreadsheets/d/1_ve_N74hK1KBMk_Rz_jVDRuLn_kDk13FUROkeNKR5P4/export?format=csv');
                const csvData = await response.text();
                const rows = csvData.split('\n').slice(1); // Skip header
                
                let authenticated = false;
                let foundRole = null;
                
                for (let row of rows) {
                    const columns = row.split(',');
                    if (columns.length >= 7) {
                        const email = columns[0]?.trim().replace(/"/g, '');
                        const role = columns[2]?.trim().replace(/"/g, '');
                        const pass = columns[6]?.trim().replace(/"/g, '');
                        
                        if (email && (email.toLowerCase() === username.toLowerCase()) && pass === password) {
                            authenticated = true;
                            foundRole = role.toLowerCase();
                            currentUser = email;
                            break;
                        }
                    }
                }
                
                if (authenticated && foundRole) {
                    userRole = foundRole;
                    showDashboard();
                } else {
                    throw new Error('Invalid credentials');
                }
                
            } catch (error) {
                loginError.textContent = 'Invalid username or password. Please try again.';
                loginError.classList.remove('hidden');
            } finally {
                loginLoading.classList.add('hidden');
            }
        });

        function showDashboard() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('dashboard').classList.remove('hidden');
            document.getElementById('userName').textContent = currentUser;
            document.getElementById('userRole').textContent = userRole.toUpperCase();
            
            generateTabs();
            showTab('overview');
        }

        function generateTabs() {
            const tabsContainer = document.getElementById('mainTabs');
            const allowedTabs = rolePermissions[userRole] || [];
            
            tabsContainer.innerHTML = '';
            
            allowedTabs.forEach((tabId, index) => {
                const tabButton = document.createElement('button');
                tabButton.className = `tab-button flex items-center py-4 px-1 border-b-2 font-medium text-sm ${index === 0 ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'}`;
                tabButton.setAttribute('data-target', tabId);
                tabButton.innerHTML = `<i class="${tabIcons[tabId]} mr-2"></i>${tabNames[tabId]}`;
                tabButton.addEventListener('click', () => showTab(tabId));
                tabsContainer.appendChild(tabButton);
            });
        }

        function showTab(tabId) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabId).classList.add('active');
            
            // Update tab button states
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('border-blue-500', 'text-blue-600');
                button.classList.add('border-transparent', 'text-gray-500');
            });
            
            const activeButton = document.querySelector(`[data-target="${tabId}"]`);
            if (activeButton) {
                activeButton.classList.remove('border-transparent', 'text-gray-500');
                activeButton.classList.add('border-blue-500', 'text-blue-600');
            }
        }

        // Finance subtabs
        document.querySelectorAll('.finance-subtab').forEach(button => {
            button.addEventListener('click', function() {
                const target = this.getAttribute('data-target');
                
                // Hide all subtab contents
                document.querySelectorAll('.subtab-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // Show selected subtab
                document.getElementById(target).classList.add('active');
                
                // Update subtab button states
                document.querySelectorAll('.finance-subtab').forEach(btn => {
                    btn.classList.remove('border-blue-500', 'text-blue-600');
                    btn.classList.add('border-transparent', 'text-gray-500');
                });
                
                this.classList.remove('border-transparent', 'text-gray-500');
                this.classList.add('border-blue-500', 'text-blue-600');
            });
        });

        // Iframe error handling
        function handleIframeLoad(system) {
            // Check if iframe loaded successfully
            setTimeout(() => {
                const iframe = document.getElementById(system + 'Iframe');
                const errorDiv = document.getElementById(system + 'Error');
                
                try {
                    // Try to access iframe content to detect cross-origin issues
                    iframe.contentWindow.location.href;
                } catch (e) {
                    // Cross-origin restriction detected
                    if (e.name === 'SecurityError') {
                        errorDiv.classList.add('show');
                    }
                }
            }, 3000);
        }

        function handleIframeError(system) {
            const errorDiv = document.getElementById(system + 'Error');
            errorDiv.classList.add('show');
        }

        function retryCoretaxEmbed() {
            const iframe = document.getElementById('coretaxIframe');
            const errorDiv = document.getElementById('coretaxError');
            
            errorDiv.classList.remove('show');
            iframe.src = iframe.src; // Reload iframe
            
            setTimeout(() => {
                handleIframeLoad('coretax');
            }, 1000);
        }

        function refreshPPM() {
            const iframe = document.getElementById('ppmIframe');
            iframe.src = iframe.src;
        }

        function refreshCoretax() {
            const iframe = document.getElementById('coretaxIframe');
            const errorDiv = document.getElementById('coretaxError');
            
            errorDiv.classList.remove('show');
            iframe.src = iframe.src;
        }

        // Logout
        document.getElementById('logoutBtn').addEventListener('click', function() {
            currentUser = null;
            userRole = null;
            document.getElementById('dashboard').classList.add('hidden');
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        });

        // Auto-detect iframe loading issues
        window.addEventListener('message', function(event) {
            if (event.data === 'iframe-blocked') {
                document.getElementById('coretaxError').classList.add('show');
            }
        });

        // Initialize iframe error detection
        setTimeout(() => {
            const coretaxIframe = document.getElementById('coretaxIframe');
            if (coretaxIframe) {
                coretaxIframe.addEventListener('load', () => handleIframeLoad('coretax'));
            }
        }, 1000);
    </script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"954849b3684c99a9","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.6.2","token":"4edd5f8ec12a48cfa682ab8261b80a79"}' crossorigin="anonymous"></script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDrq2KqNJmcY3cO6mb35a8LBke5xCyo1fQaCsc%2F2g9syZ8fhzYJAlD80TCDGXJk4DrHTFZ7OJdm58Eydl1SLkqUxyeRrhrNlY3J8GZ5GUGTW9sioBbIZTpHOmpK7hf4RHULeROjMHG0LihYbtv2Ok855Z7WNisqejhKT%2Fs8OEqdWSKOlS0PkomtQkmvTJ4%2BHI%2Bs04YgJnVEZepg8t%2B4z8EIqVbTYpPITIjQ4qi9fEbu062b1Z1jpHfPwrrZJ7SgXMHVvBuvD5ScEZnGLGrTc%2B7%2BVKSFvx%2BTTuI6Waq7bL7J9WBXDbRYGr7hcXH%2B3%2ByT%2B03XxZgAHR0ho9oykEXxoupY95nvJQdmobWIl6O9csEZbnlD%2FAnPOL%2BMEHVu%2BKG8kWFC9FHEJZgD3Ckz4VhFZe2mEdGJC%2BJ%2Fk1vloCMKnE%2B3m%2B%2FpLPYO6fAdp0S0gO4AuyHpGvKrBnju10Y4DZbHkFg8PpVVTcW2%2FhlwVnkXdAG%2FJRKbj%2FPWCnyCWiGmvlOxlJe9KhKIYRz1TcCaNyWFlhPME%3D";
        window.__genspark_locale = "en-US";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDrq2KqNJmcY3cO6mb35a8LBke5xCyo1fQaCsc/2g9syZ8fhzYJAlD80TCDGXJk4DrHTFZ7OJdm58Eydl1SLkqUxyeRrhrNlY3J8GZ5GUGTW9sioBbIZTpHOmpK7hf4RHULeROjMHG0LihYbtv2Ok855Z7WNisqejhKT/s8OEqdWSKOlS0PkomtQkmvTJ4+HI+s04YgJnVEZepg8t+4z8EIqVbTYpPITIjQ4qi9fEbu062b1Z1jpHfPwrrZJ7SgXMHVvBuvD5ScEZnGLGrTc+7+VKSFvx+TTuI6Waq7bL7J9WBXDbRYGr7hcXH+3+yT+03XxZgAHR0ho9oykEXxoupY95nvJQdmobWIl6O9csEZbnlD/AnPOL+MEHVu+KG8kWFC9FHEJZgD3Ckz4VhFZe2mEdGJC+J/k1vloCMKnE+3m+/pLPYO6fAdp0S0gO4AuyHpGvKrBnju10Y4DZbHkFg8PpVVTcW2/hlwVnkXdAG/JRKbj/PWCnyCWiGmvlOxlJe9KhKIYRz1TcCaNyWFlhPME=";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    